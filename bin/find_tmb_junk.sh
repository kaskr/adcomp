#!/bin/bash
# -----------------------------------------------------------------------------
# bash function to find and remove .so and .o files generated by TMB
# Usage:
#   List files:     find_tmb_junk.sh
#   Remove files:   find_tmb_junk.sh -rf
# -----------------------------------------------------------------------------
if [ "$1" != '' ]
then
    if [ "$1" != '-rf' ]
    then
        echo 'use -rf to remove all files'
        exit 1
    fi
fi
## Find
array=()
SOFILES=`find . -regex ".*\.s?o" 2> /dev/null`
for i in $SOFILES ; do
  if nm $i 2> /dev/null | grep -q MakeADFunObject ; then
    array+=("$i")
  fi
done
## Report
du -hc "${array[@]}"
## Remove
if [ "$1" == '-rf' ]
then
  rm "${array[@]}"
fi
